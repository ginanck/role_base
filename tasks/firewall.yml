---

- name: gather os facts
  ansible.builtin.setup:
    gather_subset:
      - '!all'
      - '!min'
      - 'distribution'

- name: stop and disable firewalld service
  ansible.builtin.systemd:
    name: firewalld
    state: stopped
    enabled: false
    masked: yes  # Adding masking for extra protection
  ignore_errors: true
  when: ansible_os_family == 'RedHat'

- name: stop and disable ufw service
  ansible.builtin.systemd:
    name: ufw
    state: stopped
    enabled: false
    masked: yes  # Adding masking for extra protection
  ignore_errors: true
  when: ansible_os_family == 'Debian'
